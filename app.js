const puppeteer=require('puppeteer'),constants=require('./constants/constants.app');async function readInbox(b,c){try{await b['setCookie'](constants['COOKIE'](c)),await b['goto'](constants['URL']),await b['waitForTimeout'](0x3e8),await b['focus']('#login'),await b['waitForTimeout'](0x3e8),await b['keyboard']['press']('Enter'),await b['waitForSelector']('#webmail'),await b['waitForTimeout'](0x3e8);const d=b['frames']()['find'](f=>f['name']('ifinbox'));return await d['$$eval']('div.mctn>div.m',f=>{let g=[];return f['map'](h=>{let i={};i['id']=h['getAttribute']('id'),i['time']=h['querySelector']('span[class=\x22lmh\x22]')['innerText'],i['subject']=h['querySelector']('span[class=\x22lmf\x22]')['innerText'],i['content']=h['querySelector']('div[class=\x22lms\x22]')['innerText'],g['push'](i);}),g;});}catch(f){throw new Error(f);}}function createMail(){return(async()=>{try{const b=await puppeteer['launch'](constants['BROWSER_OPTIONS']),c=await b['newPage']();await c['goto'](constants['URL_GENERATOR']);const d=await c['$eval']('#egen',f=>f['textContent']['split']('login')[0x0]);return await c['waitForTimeout'](0x12c),await b['close'](),d;}catch(f){throw new Error(f);}})();}function getInbox(a){if(!a)throw new Error(constants['ERROR_MAIL_INVALID']);return(async b=>{try{const c=await puppeteer['launch'](constants['BROWSER_OPTIONS']),d=await c['newPage'](),f=await readInbox(d,b);return await d['waitForTimeout'](0x3e8),await c['close'](),f;}catch(g){throw new Error(g);}})(a);}function readMail(a,b={}){return(async(c,d)=>{let f=null,g='';try{const h=await puppeteer['launch'](constants['BROWSER_OPTIONS']),j=await h['newPage'](),k=await readInbox(j,c);if('id'in d){let l=k['find'](m=>m['id']===d['id']);l?f=l['id']:g='id\x20not\x20match\x20with\x20search!';}else{if('subject'in d){let m=k['find'](p=>p['subject']===d['subject']);m?f=m['id']:g='Subject\x20not\x20match\x20with\x20search!';}else{if('content'in d){let p=k['find'](q=>q['content']['indexOf'](d['content'])>-0x1);p?f=p['id']:g='Content\x20not\x20match\x20with\x20search!';}}}if(f){await j['waitForTimeout'](0x1f40),await j['goto']('https://yopmail.com/es/mail?b='+c+'&id=m'+f);const q=await j['evaluate'](()=>document['querySelector']('#mail')['outerHTML']);return await h['close'](),q;}return await h['close'](),g;}catch(s){throw new Error(s);}})(a['split']('@')[0x0],b);}module['exports']={'inbox':getInbox,'readMail':readMail,'createMail':createMail};